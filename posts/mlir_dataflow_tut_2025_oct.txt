1:"$Sreact.fragment"
2:I[6874,["874","static/chunks/874-437a265a67d6cfee.js","880","static/chunks/app/posts/%5Bid%5D/page-8778b7e42f8ceed2.js"],""]
3:I[7555,[],""]
4:I[1295,[],""]
5:I[7921,["874","static/chunks/874-437a265a67d6cfee.js","177","static/chunks/app/layout-6c77c7f0e287af25.js"],"default"]
7:I[9665,[],"OutletBoundary"]
9:I[4911,[],"AsyncMetadataOutlet"]
b:I[9665,[],"ViewportBoundary"]
d:I[9665,[],"MetadataBoundary"]
e:"$Sreact.suspense"
10:I[8393,[],""]
:HL["/_next/static/media/7385e8d9d3c5518f-s.p.ttf","font",{"crossOrigin":"","type":"font/ttf"}]
:HL["/_next/static/css/f55f51dd62de488d.css","style"]
:HL["/_next/static/css/8a287c41de7a8698.css","style"]
0:{"P":null,"b":"2iBmcczlFMyWBva-Ef9GB","p":"","c":["","posts","mlir_dataflow_tut_2025_oct"],"i":false,"f":[[["",{"children":["posts",{"children":[["id","mlir_dataflow_tut_2025_oct","d"],{"children":["__PAGE__",{}]}]}]},"$undefined","$undefined",true],["",["$","$1","c",{"children":[[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/f55f51dd62de488d.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","html",null,{"lang":"en","className":"px-4 py-4","children":["$","body",null,{"className":"__className_d4e0c8 flex flex-col min-h-screen","children":[["$","$L2",null,{"href":"/","children":["$","div",null,{"className":"flex justify-center items-center py-4 ","children":["$","h1",null,{"className":"text-4xl font-bold","children":"Jasmine Tang"}]}]}],["$","div",null,{"className":"flex-1","children":["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":[[["$","title",null,{"children":"404: This page could not be found."}],["$","div",null,{"style":{"fontFamily":"system-ui,\"Segoe UI\",Roboto,Helvetica,Arial,sans-serif,\"Apple Color Emoji\",\"Segoe UI Emoji\"","height":"100vh","textAlign":"center","display":"flex","flexDirection":"column","alignItems":"center","justifyContent":"center"},"children":["$","div",null,{"children":[["$","style",null,{"dangerouslySetInnerHTML":{"__html":"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}"}}],["$","h1",null,{"className":"next-error-h1","style":{"display":"inline-block","margin":"0 20px 0 0","padding":"0 23px 0 0","fontSize":24,"fontWeight":500,"verticalAlign":"top","lineHeight":"49px"},"children":404}],["$","div",null,{"style":{"display":"inline-block"},"children":["$","h2",null,{"style":{"fontSize":14,"fontWeight":400,"lineHeight":"49px","margin":0},"children":"This page could not be found."}]}]]}]}]],[]],"forbidden":"$undefined","unauthorized":"$undefined"}]}],["$","$L5",null,{}],["$","footer",null,{"className":"footer self-center justify-center gap-2 pt-4 items-center italic ","children":["$","p",null,{"children":"Built by Jasmine with NextJS, TailwindCSS, and a tonnn of loveee :)"}]}]]}]}]]}],{"children":["posts",["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":[["id","mlir_dataflow_tut_2025_oct","d"],["$","$1","c",{"children":[null,["$","$L3",null,{"parallelRouterKey":"children","error":"$undefined","errorStyles":"$undefined","errorScripts":"$undefined","template":["$","$L4",null,{}],"templateStyles":"$undefined","templateScripts":"$undefined","notFound":"$undefined","forbidden":"$undefined","unauthorized":"$undefined"}]]}],{"children":["__PAGE__",["$","$1","c",{"children":["$L6",[["$","link","0",{"rel":"stylesheet","href":"/_next/static/css/8a287c41de7a8698.css","precedence":"next","crossOrigin":"$undefined","nonce":"$undefined"}]],["$","$L7",null,{"children":["$L8",["$","$L9",null,{"promise":"$@a"}]]}]]}],{},null,false]},null,false]},null,false]},null,false],["$","$1","h",{"children":[null,[["$","$Lb",null,{"children":"$Lc"}],["$","meta",null,{"name":"next-size-adjust","content":""}]],["$","$Ld",null,{"children":["$","div",null,{"hidden":true,"children":["$","$e",null,{"fallback":null,"children":"$Lf"}]}]}]]}],false]],"m":"$undefined","G":["$10",[]],"s":false,"S":true}
c:[["$","meta","0",{"charSet":"utf-8"}],["$","meta","1",{"name":"viewport","content":"width=device-width, initial-scale=1"}]]
8:null
11:I[8175,[],"IconMark"]
a:{"metadata":[["$","title","0",{"children":"[ONGOING] Dataflow analysis in MLIR: A walkthrough"}],["$","meta","1",{"name":"description","content":"Jasmine walks through the MLIR dataflow analysis landscape in 2025"}],["$","link","2",{"rel":"icon","href":"/_next/static/media/pfp6.723cdd8c.png"}],["$","$L11","3",{}]],"error":null,"digest":"$undefined"}
f:"$a:metadata"
12:T76fe,<nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#introduction">Introduction</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#pre-req">Pre-req</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#overall-framework">Overall framework</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#lattices">Lattices</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#latticeanchor">LatticeAnchor</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#analysisstate">AnalysisState</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#abstractsparselattice--public-analysisstate">AbstractSparseLattice : public AnalysisState</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#executable--public-analysisstate-and-deadcodeanalysis">Executable : public AnalysisState and DeadcodeAnalysis</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#constantvalue-and-constantpropagationanalysis">ConstantValue and ConstantPropagationAnalysis</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#forward-and-backward-analysis">Forward and backward analysis</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#dataflowsolver">DataflowSolver</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#sparseforwardanalysis-and-sparsebackwardanalysis">SparseForwardAnalysis and SparseBackwardAnalysis</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#generic-iterative-analysis">Generic iterative analysis</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#demo">Demo</a></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#case-study-intrangeanalysis">Case study: IntRangeAnalysis</a></li></ol></nav><p>Hi everyone, how's everybody doing? Wow, it's almost the end of 2025 isn't it?
I started doing the blog in 2024 as a way to bla bla bla bla a lot of memories bla bla bla bla.</p>
<p>With each blog coming out every 2 or 3 months, I guess this is the end for 2025? Hahahhaha.</p>
<p>Music rec: something christmas.</p>
<h1 id="introduction"><a aria-hidden="true" tabindex="-1" href="#introduction"><span class="icon icon-link"></span></a>Introduction</h1>
<p>Dataflow analysis is an important technique in compilers. Even with tons of resources on dataflow analysis, it is not always
easy to operate such technique in a concrete implementation(?! todo: redo this bruv, doesn't sound good).</p>
<p>Even though there has been a tutorial for it, as well a pull request to update it, I still want to add this article as a
report on what I've found out reading around in the dataflow codebase.</p>
<p>With LLVM featuring a more time-tested approach to tutorials, I also want to give this article a closer look and a more intrapersonal
read to it.</p>
<p>Happy reading everyone.</p>
<h1 id="pre-req"><a aria-hidden="true" tabindex="-1" href="#pre-req"><span class="icon icon-link"></span></a>Pre-req</h1>
<p>A lot of my reading and understanding is drawn from Engineering a Compiler, chapter 9 specifically. So when a text is
put between double quotes, or is quoted somehow, you can assume it is from said book.</p>
<p>You can find the book readily available for free on the internet. Here, I'll quote a few necessary snippets to remind readers.</p>
<h1 id="overall-framework"><a aria-hidden="true" tabindex="-1" href="#overall-framework"><span class="icon icon-link"></span></a>Overall framework</h1>
<p>All the framework code lives in <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span>mlir/lib/Analysis</span></span><button type="button" title="Copy code" aria-label="Copy code" data="mlir/lib/Analysis" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span> and <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span>mlir/lib/Analysis</span></span><button type="button" title="Copy code" aria-label="Copy code" data="mlir/lib/Analysis" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span>. First, let's go over the classes
that represents lattices, then the drivers for the dataflow analysis.</p>
<h2 id="lattices"><a aria-hidden="true" tabindex="-1" href="#lattices"><span class="icon icon-link"></span></a>Lattices</h2>
<h3 id="latticeanchor"><a aria-hidden="true" tabindex="-1" href="#latticeanchor"><span class="icon icon-link"></span></a>LatticeAnchor</h3>
<p>The LatticeAnchor class is actually a pointer union between three different classes:</p>
<ul>
<li>ProgramPoint: a specific location in the program. From its constructor <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span> ProgramPoint(Block *parentBlock, Block::iterator pp)</span></span><button type="button" title="Copy code" aria-label="Copy code" data=" ProgramPoint(Block *parentBlock, Block::iterator pp)" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span> and <span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span>  ProgramPoint(Operation *op) : op(op) {}</span></span><button type="button" title="Copy code" aria-label="Copy code" data="  ProgramPoint(Operation *op) : op(op) {}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span>, you can technically</li>
<li>Value: an SSA value.</li>
<li>GenericLatticeAnchor: Other cases that is not covered by ProgramPoint or Value, like a CFGEdge cases that is not covered
by ProgramPoint or Value, like a CFGEdge in  the case of dead code analysis. (TODO: also give a clearer why, not just say CFGEdge).
from the comments in the codebase: "In classical data-flow analysis,
lattice anchor represent positions in a program to which lattice elements
are attached."</li>
</ul>
<p>IMO, the LatticeAnchor class models something that can carry the lattice value. This is not to be confused with
the next class that we'll talk about, the AnalysisState class.</p>
<h3 id="analysisstate"><a aria-hidden="true" tabindex="-1" href="#analysisstate"><span class="icon icon-link"></span></a>AnalysisState</h3>
<p>Base class for generic analysis states. Analysis states contain data-flow
information that are attached to lattice anchors and which evolve as the
analysis iterates.</p>
<p>If LatticeAnchor talks about the class that can carry the lattice value, then the AnalysisState class represents the lattice value itself.</p>
<p>Since this is a base class, it doesn't inherently have a value that can represent a lattice. Rather, the class provides utilities
to</p>
<ul>
<li>which points in the program to notify the dataflow solver to further analyze if my state change (addDependency())</li>
<li>which point in the program am I representing? (getAnchor())</li>
</ul>
<h3 id="abstractsparselattice--public-analysisstate"><a aria-hidden="true" tabindex="-1" href="#abstractsparselattice--public-analysisstate"><span class="icon icon-link"></span></a>AbstractSparseLattice : public AnalysisState</h3>
<p>AbstractSparseLattice specializes in representing lattice state for SSA values.
Here, we start seeing more distinct shape of a lattice state, with functions like join() and meet().</p>
<p>A fun fact is both SparseForwardAnalysis (SFA) and SparseBackwardAnalysis (SBA) requires the lattice class to subclass AbstractSparseLattice .</p>
<p>to subclass AbstractSparseLattice, users just have to implement the printing method and depending on if the lattice will
be use in a forward or backward style, implement join() or meet()</p>
<h3 id="executable--public-analysisstate-and-deadcodeanalysis"><a aria-hidden="true" tabindex="-1" href="#executable--public-analysisstate-and-deadcodeanalysis"><span class="icon icon-link"></span></a>Executable : public AnalysisState and DeadcodeAnalysis</h3>
<p>The Executable class is a very important class in the dataflow framework in MLIR. The class represents if a code is dead or not.
Normally, it is not helpful to talk about every single class that subclasses AnalysisState; this blog would be too long then.
But since both SFA and SBA requires the Executable lattice state and by default, the
Executable lattice state is false, if you fail to load the deadcode analysis before loading your own analysis when basing your
analysis off of SFA or SBA, no analysis will be done.</p>
<p>The loading of deadcode analysis can be done as follows:</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="cpp" data-theme="github-dark-dimmed"><code data-language="cpp" data-theme="github-dark-dimmed" style="display: grid;"><span data-line=""><span style="color:#F47067">#include</span><span style="color:#96D0FF"> &#x3C;mlir/Analysis/DataFlow/DeadCodeAnalysis.h></span></span>
<span data-line=""><span style="color:#768390">// initializing the solver</span></span>
<span data-line=""><span style="color:#ADBAC7">... </span><span style="color:#6cb6ff">{</span></span>
<span data-line=""><span style="color:#ADBAC7">    solver.load</span><span style="color:#F47067">&#x3C;</span><span style="color:#F69D50">mlir</span><span style="color:#ADBAC7">::</span><span style="color:#F69D50">dataflow</span><span style="color:#ADBAC7">::DeadCodeAnalysis</span><span style="color:#F47067">></span><span style="color:#6bc46d">(</span><span style="color:#6bc46d">)</span><span style="color:#ADBAC7">;</span></span>
<span data-line=""><span style="color:#6cb6ff">}</span></span><button type="button" title="Copy code" aria-label="Copy code" data="#include <mlir/Analysis/DataFlow/DeadCodeAnalysis.h>
// initializing the solver
... {
    solver.load<mlir::dataflow::DeadCodeAnalysis>();
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<p>An example of SparseForwardAnalysis relying on</p>
<h3 id="constantvalue-and-constantpropagationanalysis"><a aria-hidden="true" tabindex="-1" href="#constantvalue-and-constantpropagationanalysis"><span class="icon icon-link"></span></a>ConstantValue and ConstantPropagationAnalysis</h3>
<p>If the opening paragraph of the Executable class discusses how SFA and SBA relies on DeadCodeAnalysis, the following section talks about how
DeadCodeAnalysis itself relies on ConstantPropagationAnalysis to function in the context of control flow.</p>
<p>If we havne't load the solver with the ConstantPropagationAnalysis pass, in the function visitBranchOperation, when we encounter
getOperandValues, operands will always be nullopt, leading to the edges uninitialized, which is automatically assumed as false.</p>
<figure data-rehype-pretty-code-figure=""><pre tabindex="0" data-language="plaintext" data-theme="github-dark-dimmed"><code data-language="plaintext" data-theme="github-dark-dimmed" style="display: grid;"><span data-line=""><span>void DeadCodeAnalysis::visitBranchOperation(BranchOpInterface branch) {</span></span>
<span data-line=""><span>// Try to deduce a single successor for the branch.</span></span>
<span data-line=""><span>    std::optional&#x3C;SmallVector&#x3C;Attribute>> operands = getOperandValues(branch);</span></span>
<span data-line=""><span>    if (!operands)</span></span>
<span data-line=""><span>        return;</span></span>
<span data-line=""> </span>
<span data-line=""><span>    if (Block *successor = branch.getSuccessorForOperands(*operands)) {</span></span>
<span data-line=""><span>        markEdgeLive(branch->getBlock(), successor);</span></span>
<span data-line=""><span>    } else {</span></span>
<span data-line=""><span>        // Otherwise, mark all successors as executable and outgoing edges.</span></span>
<span data-line=""><span>        for (Block *successor : branch->getSuccessors())</span></span>
<span data-line=""><span>            markEdgeLive(branch->getBlock(), successor);</span></span>
<span data-line=""><span>    }</span></span>
<span data-line=""><span>}</span></span>
<span data-line=""> </span>
<span data-line=""> </span>
<span data-line=""><span>```cpp</span></span>
<span data-line=""><span>#include &#x3C;mlir/Analysis/DataFlow/ConstantPropagationAnalysis.h></span></span>
<span data-line=""><span>// initializing the solver</span></span>
<span data-line=""><span>... {</span></span>
<span data-line=""><span>    solver.load&#x3C;mlir::dataflow::SparseConstantPropagation>();</span></span>
<span data-line=""><span>}</span></span><button type="button" title="Copy code" aria-label="Copy code" data="void DeadCodeAnalysis::visitBranchOperation(BranchOpInterface branch) {
// Try to deduce a single successor for the branch.
    std::optional<SmallVector<Attribute>> operands = getOperandValues(branch);
    if (!operands)
        return;

    if (Block *successor = branch.getSuccessorForOperands(*operands)) {
        markEdgeLive(branch->getBlock(), successor);
    } else {
        // Otherwise, mark all successors as executable and outgoing edges.
        for (Block *successor : branch->getSuccessors())
            markEdgeLive(branch->getBlock(), successor);
    }
}


&#x60;&#x60;&#x60;cpp
#include <mlir/Analysis/DataFlow/ConstantPropagationAnalysis.h>
// initializing the solver
... {
    solver.load<mlir::dataflow::SparseConstantPropagation>();
}" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></pre></figure>
<h2 id="forward-and-backward-analysis"><a aria-hidden="true" tabindex="-1" href="#forward-and-backward-analysis"><span class="icon icon-link"></span></a>Forward and backward analysis</h2>
<p>TODO: talk about which method to implement and why it's important.</p>
<ul>
<li>
<p><span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span>virtual void print(raw_ostream &#x26;os) const override</span></span><button type="button" title="Copy code" aria-label="Copy code" data="virtual void print(raw_ostream &#x26;os) const override" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span>:</p>
</li>
<li>
<p><span data-rehype-pretty-code-figure=""><code data-language="plaintext" data-theme="github-dark-dimmed"><span data-line=""><span>virtual ChangeResult join(const AbstractSparseLattice &#x26;other) override</span></span><button type="button" title="Copy code" aria-label="Copy code" data="virtual ChangeResult join(const AbstractSparseLattice &#x26;other) override" class="rehype-pretty-copy" onclick="navigator.clipboard.writeText(this.attributes.data.value);this.classList.add(&#x27;rehype-pretty-copied&#x27;);window.setTimeout(() => this.classList.remove(&#x27;rehype-pretty-copied&#x27;), 3000);"><span class="ready"></span><span class="success"></span></button><style>:root {--copy-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 48 48'%3E%3Cpath fill='%23adadad' d='M16.187 9.5H12.25a1.75 1.75 0 0 0-1.75 1.75v28.5c0 .967.784 1.75 1.75 1.75h23.5a1.75 1.75 0 0 0 1.75-1.75v-28.5a1.75 1.75 0 0 0-1.75-1.75h-3.937a4.25 4.25 0 0 1-4.063 3h-7.5a4.25 4.25 0 0 1-4.063-3M31.813 7h3.937A4.25 4.25 0 0 1 40 11.25v28.5A4.25 4.25 0 0 1 35.75 44h-23.5A4.25 4.25 0 0 1 8 39.75v-28.5A4.25 4.25 0 0 1 12.25 7h3.937a4.25 4.25 0 0 1 4.063-3h7.5a4.25 4.25 0 0 1 4.063 3M18.5 8.25c0 .966.784 1.75 1.75 1.75h7.5a1.75 1.75 0 1 0 0-3.5h-7.5a1.75 1.75 0 0 0-1.75 1.75'/%3E%3C/svg%3E");--success-icon: url("data:image/svg+xml,%3Csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 24 24'%3E%3Cpath fill='%2366ff85' d='M9 16.17L5.53 12.7a.996.996 0 1 0-1.41 1.41l4.18 4.18c.39.39 1.02.39 1.41 0L20.29 7.71a.996.996 0 1 0-1.41-1.41z'/%3E%3C/svg%3E");}pre:has(code) {position: relative;}pre button.rehype-pretty-copy {right: 1px;padding: 0;width: 24px;height: 24px;display: flex;margin-top: 2px;margin-right: 8px;position: absolute;border-radius: 25%;backdrop-filter: blur(3px);& span {width: 100%;aspect-ratio: 1 / 1;}& .ready {background-image: var(--copy-icon);}& .success {display: none; background-image: var(--success-icon);}}&.rehype-pretty-copied {& .success {display: block;} & .ready {display: none;}}pre button.rehype-pretty-copy.rehype-pretty-copied {opacity: 1;& .ready { display: none; }& .success { display: block; }}</style></code></span>:</p>
</li>
<li>
<p>SetToEntryState: when an IR change, that might make the fact no longer true anymore, redo it.</p>
</li>
</ul>
<h3 id="dataflowsolver"><a aria-hidden="true" tabindex="-1" href="#dataflowsolver"><span class="icon icon-link"></span></a>DataflowSolver</h3>
<h3 id="sparseforwardanalysis-and-sparsebackwardanalysis"><a aria-hidden="true" tabindex="-1" href="#sparseforwardanalysis-and-sparsebackwardanalysis"><span class="icon icon-link"></span></a>SparseForwardAnalysis and SparseBackwardAnalysis</h3>
<p>With the large number of dialects that MLIR has, a person should better stay within the framework of the dataflow analysis to
ensure the minimal time to set up and less debugging headache :)</p>
<p>The dataflow framework introduces two kind of dataflow analysis that users can inherit from, forward and backward,
each inheriting from SparseForwardAnalysis and SparseBackwardAnalysis. One
thing interesting to note is that DeadCodeAnalysis itself inherit directly from DataFlowAnalysis. While this is possible,
I want to note that it's not advisable and should only be done if you're looking for some kind of specialized flavor of dataflow analysis.</p>
<h2 id="generic-iterative-analysis"><a aria-hidden="true" tabindex="-1" href="#generic-iterative-analysis"><span class="icon icon-link"></span></a>Generic iterative analysis</h2>
<p>DeadCodeAnalysis is an example of this.</p>
<h2 id="demo"><a aria-hidden="true" tabindex="-1" href="#demo"><span class="icon icon-link"></span></a>Demo</h2>
<p>Metadata analysis</p>
<h1 id="case-study-intrangeanalysis"><a aria-hidden="true" tabindex="-1" href="#case-study-intrangeanalysis"><span class="icon icon-link"></span></a>Case study: IntRangeAnalysis</h1>6:["$","div",null,{"className":"py-12 flex flex-col items-center  justify-items-start mx-auto ","children":[["$","$L2",null,{"href":"/blog","className":"flex justify-center text-4xl","children":["$","h2",null,{"children":"My blog"}]}],["$","article",null,{"className":"p-8 prose pt-0.5 max-w-none w-full lg:w-1/2 md:w-4/6 sm:w-5/6 prose-sky mx-auto","children":[["$","div",null,{"className":"flex justify-center text-2xl font-bold ","children":["$","h2",null,{"children":"[ONGOING] Dataflow analysis in MLIR: A walkthrough"}]}],["$","div",null,{"className":"flex justify-start text-xl font-bold underline","children":["$","h4",null,{"children":"8888-08-08"}]}],["$","div",null,{"dangerouslySetInnerHTML":{"__html":"$12"}}]]}]]}]
