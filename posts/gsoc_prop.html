<!DOCTYPE html><html lang="en" class="px-4 py-4"><head><meta charSet="utf-8"/><meta name="viewport" content="width=device-width, initial-scale=1"/><link rel="preload" href="/_next/static/media/7385e8d9d3c5518f-s.p.ttf" as="font" crossorigin="" type="font/ttf"/><link rel="stylesheet" href="/_next/static/css/c964a4de8175fdfc.css" data-precedence="next"/><link rel="stylesheet" href="/_next/static/css/7ad14cf05ba66ef7.css" data-precedence="next"/><link rel="preload" as="script" fetchPriority="low" href="/_next/static/chunks/webpack-a3e322df7e912d9b.js"/><script src="/_next/static/chunks/4bd1b696-cc921fdf64582ac2.js" async=""></script><script src="/_next/static/chunks/517-f9c47ac1c3159d98.js" async=""></script><script src="/_next/static/chunks/main-app-64657d68b3fa7103.js" async=""></script><script src="/_next/static/chunks/173-ad05a37061268ac6.js" async=""></script><script src="/_next/static/chunks/app/posts/%5Bid%5D/page-0a046863f2056281.js" async=""></script><script src="/_next/static/chunks/565-d3001cb0b7ac580c.js" async=""></script><script src="/_next/static/chunks/app/layout-23d97ae8d15fbd69.js" async=""></script><meta name="next-size-adjust" content=""/><title>jjasmine’s Gsoc GCCRS proposal</title><meta name="description" content="Built with NextJS, TailwindCSS, and a tonnn of loveee :)"/><link rel="icon" href="/_next/static/media/pfp5.0daa0f7d.jpeg"/><script src="/_next/static/chunks/polyfills-42372ed130431b0a.js" noModule=""></script></head><body class="__className_d4e0c8 flex flex-col min-h-screen"><a href="/"><div class="flex justify-center items-center py-4 "><h1 class="text-4xl font-bold">Jasmine Tang</h1></div></a><div class="flex-1"><div class="py-12 flex flex-col items-center  justify-items-start mx-auto "><a class="flex justify-center text-4xl" href="/blog"><h2>My blog</h2></a><article class="p-8 prose pt-0.5 max-w-none w-full lg:w-1/2 md:w-4/6 sm:w-5/6 prose-sky mx-auto"><div class="flex justify-center text-2xl font-bold "><h2>jjasmine’s Gsoc GCCRS proposal</h2></div><div class="flex justify-start text-xl font-bold underline"><h4>2024-05-04</h4></div><div class="flex font-bold">Edit:</div>My resume is <a href="https://badumbatish.github.io/about_me/Jasmine_Resume_Badumbatish.pdf">here</a>. If you know of a compiler related job posting, please feel free to contact me or refer me at either <a href="tanghocle456@gmail.com">tanghocle456@gmail.com</a> or <a href="jjasmine@berkeley.edu">jjasmine@berkeley.edu</a>.<hr/><div><nav class="toc"><ol class="toc-level toc-level-1"><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#prologue">Prologue</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#jjasmines-gsoc-gccrs-proposal">jjasmine’s Gsoc GCCRS proposal</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#gsoc-proposal-inline-assembly-support">Gsoc Proposal: Inline assembly Support</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#project">Project</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#goals">Goals</a></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#expected-timeline--responsibitilies">Expected timeline &#x26; responsibitilies</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#expected-timeline">Expected timeline</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format">WEEK 1-3 (May 27 - June 17): Implement and test the parser to convert rust asm format to gcc asm format.</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor">WEEK 4 (June 17 - June 24): Improve (if possible) asm-AST in rust-macro-builtins, implement asm-HIR and visitor</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens">WEEK 5 (June 24 - July 1): Implement handlers for asm, creating AST asm from a stream of tokens.</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir">WEEK 6-7 (July 1 - July 15): Work with ASTLowering, lowering the asm-AST to HIR (high level IR).</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language">WEEK 7-8 (July 15 - July 29): Work with GENERIC IL in Compile*, converting HIR to GENERIC intermediate language.</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-9-july-29---aug-5-end-to-end-testing">WEEK 9 (July 29 - Aug 5): End-to-end testing.</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects">WEEK 11-12 (Aug 5 - 19): Spare time allocation for different parts of projects.</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#week-10-aug-19---aug-26-report-and-documentation">WEEK 10 (Aug 19 - Aug 26): Report and Documentation</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#responsibitiles-and-my-schedule">Responsibitiles and my schedule.</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#university">University</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#internship">Internship</a></li></ol></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#design-doc">Design doc</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#lexer--parser-implementation">Lexer &#x26; Parser implementation</a><ol class="toc-level toc-level-3"><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#grammar">Grammar</a></li><li class="toc-item toc-item-h3"><a class="toc-link toc-link-h3" href="#implementation">Implementation</a></li></ol></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#rust-asm-ast-hir-and-visitor">rust asm-ast, HIR, and visitor</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#asm-handlers">asm-handlers</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#astlowering">ASTLowering</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#converting-hir-to-generic-intermediate-language">Converting HIR to GENERIC intermediate language</a></li></ol></li><li class="toc-item toc-item-h1"><a class="toc-link toc-link-h1" href="#introduce-myself-my-skills-and-accomplishments">Introduce myself, my skills and accomplishments</a><ol class="toc-level toc-level-2"><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#information">Information</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#about-myself">About myself</a></li><li class="toc-item toc-item-h2"><a class="toc-link toc-link-h2" href="#my-contribution-to-gccrs">My contribution to gccrs</a></li></ol></li></ol></nav><h1 id="prologue"><a aria-hidden="true" tabindex="-1" href="#prologue"><span class="icon icon-link"></span></a>Prologue</h1>
<p>Hi everyone, I hope you're doing great. This is an archive of my GSoc 2024 proposal: Inline Assembly in gccrs.</p>
<p>Also here's a <a href="https://www.youtube.com/watch?v=hSYfVjRMeis&#x26;ab_channel=darkcat-Topic" rel="nofollow" target="_blank">song</a> for you :)</p>
<p>I hope
you enjoy!</p>
<h1 id="jjasmines-gsoc-gccrs-proposal"><a aria-hidden="true" tabindex="-1" href="#jjasmines-gsoc-gccrs-proposal"><span class="icon icon-link"></span></a>jjasmine’s Gsoc GCCRS proposal</h1>
<h1 id="gsoc-proposal-inline-assembly-support"><a aria-hidden="true" tabindex="-1" href="#gsoc-proposal-inline-assembly-support"><span class="icon icon-link"></span></a>Gsoc Proposal: Inline assembly Support</h1>
<h1 id="project"><a aria-hidden="true" tabindex="-1" href="#project"><span class="icon icon-link"></span></a>Project</h1>
<p>From the gccrs github, "gccrs is a full alternative implementation of the Rust language ontop of GCC with the goal to become fully upstream with the GNU toolchain."</p>
<p>One of the steps to reach its implementation counterpart's parity (rustc) is the support of inline assembly. Enabling this feature allows programmers to work on low level situation where some extra performance is always needed.</p>
<p>An example is where you would want to handle the case of moving 16-bit data when the data is not exactly 64-bit.</p>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#737994;font-style:italic">// https://github.com/rust-lang/rust/blob/</span></span>
<span class="line"><span style="color:#737994;font-style:italic">// b3df0d7e5ef5f7dbeeca3fb289c65680ad013f87/library/std/src/sys/pal/sgx/abi/</span></span>
<span class="line"><span style="color:#737994;font-style:italic">// usercalls/alloc.rs#L330</span></span>
<span class="line"><span style="color:#CA9EE6">unsafe</span><span style="color:#CA9EE6"> fn</span><span style="color:#8CAAEE;font-style:italic"> copy_quadwords</span><span style="color:#949CBB">(</span><span style="color:#EA999C">src</span><span style="color:#81C8BE">:</span><span style="color:#81C8BE"> *</span><span style="color:#CA9EE6">const</span><span style="color:#CA9EE6"> u8</span><span style="color:#949CBB">,</span><span style="color:#EA999C"> dst</span><span style="color:#81C8BE">:</span><span style="color:#81C8BE"> *</span><span style="color:#CA9EE6">mut</span><span style="color:#CA9EE6"> u8</span><span style="color:#949CBB">,</span><span style="color:#EA999C"> len</span><span style="color:#81C8BE">:</span><span style="color:#CA9EE6"> usize</span><span style="color:#949CBB">)</span><span style="color:#949CBB"> {</span></span>
<span class="line"><span style="color:#CA9EE6">    unsafe</span><span style="color:#949CBB"> {</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">        asm!</span><span style="color:#949CBB">(</span></span>
<span class="line"><span style="color:#A6D189">            "rep movsq (%rsi), (%rdi)"</span><span style="color:#949CBB">,</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">            inout</span><span style="color:#949CBB">(</span><span style="color:#A6D189">"rcx"</span><span style="color:#949CBB">)</span><span style="color:#C6D0F5"> len </span><span style="color:#81C8BE">/</span><span style="color:#EF9F76"> 8</span><span style="color:#81C8BE"> =></span><span style="color:#C6D0F5"> _</span><span style="color:#949CBB">,</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">            inout</span><span style="color:#949CBB">(</span><span style="color:#A6D189">"rdi"</span><span style="color:#949CBB">)</span><span style="color:#C6D0F5"> dst </span><span style="color:#81C8BE">=></span><span style="color:#C6D0F5"> _</span><span style="color:#949CBB">,</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">            inout</span><span style="color:#949CBB">(</span><span style="color:#A6D189">"rsi"</span><span style="color:#949CBB">)</span><span style="color:#C6D0F5"> src </span><span style="color:#81C8BE">=></span><span style="color:#C6D0F5"> _</span><span style="color:#949CBB">,</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">            options</span><span style="color:#949CBB">(</span><span style="color:#C6D0F5">att_syntax</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> nostack</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> preserves_flags</span><span style="color:#949CBB">)</span></span>
<span class="line"><span style="color:#949CBB">        );</span></span>
<span class="line"><span style="color:#949CBB">    }</span></span>
<span class="line"><span style="color:#949CBB">}</span></span></code></pre>
<p>The project focuses on adding implementation for two built-in Rust macros: <code>asm!()</code>, and <code>global_asm!()</code>.</p>
<p>The gcc compiler will be able to detect parse the assembly code within asm!, and global_asm! macro, converting them to gcc assembly format to eventually generate code.</p>
<h1 id="goals"><a aria-hidden="true" tabindex="-1" href="#goals"><span class="icon icon-link"></span></a>Goals</h1>
<p>This work will require modifications to multiple parts of our compiler, with the creation of built-in macro expanders, AST nodes, HIR nodes, as well as the development of a Rust inline-assembly parser to then convert it to the GCC inline assembly format:</p>
<ul>
<li>Develop a Rust inline assembly parser.</li>
<li>Improve AST inline assembly node.</li>
<li>Construct HIR inline assembly node.</li>
<li>Construct HIR node visitor for the Lowering process.</li>
<li>Implement the HIR -> Generic IL process for inline assembly HIR nodes.</li>
<li>End to test testing of the new gccrs compiler for parity with rustc</li>
</ul>
<h1 id="expected-timeline--responsibitilies"><a aria-hidden="true" tabindex="-1" href="#expected-timeline--responsibitilies"><span class="icon icon-link"></span></a>Expected timeline &#x26; responsibitilies</h1>
<p>The project (coding aspect) is classified as 175 hours (medium) spanning from May 27 to August 26 (3 months or 12 weeks). This equates to 175/12 = 14.58 hours per week, or 2 hours per day.</p>
<p>The first subsection serves as a mini design doc where I explain my timeline and expand to my implementation goals.</p>
<p>The second subsection goes over my schedule and other responsibilities I have over summer and how I plan to counteract that.</p>
<h2 id="expected-timeline"><a aria-hidden="true" tabindex="-1" href="#expected-timeline"><span class="icon icon-link"></span></a>Expected timeline</h2>
<h3 id="week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format"><a aria-hidden="true" tabindex="-1" href="#week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format"><span class="icon icon-link"></span></a>WEEK 1-3 (May 27 - June 17): Implement and test the parser to convert rust asm format to gcc asm format.</h3>
<p>Since Rust follows a different convention in calling its assembly than C/C++, I need to parse and capture the information so that in later stages, I can use the information as arguments into one of gcc’s available function call regarding inline assembly.
The parser will be a recursive-descent parser, adhering to the ABNF syntax described at <a href="https://doc.rust-lang.org/reference/inline-assembly.html" rel="nofollow" target="_blank">https://doc.rust-lang.org/reference/inline-assembly.html</a></p>
<p>The programmer (me in this case) will need to learn about gccrs’ token stream API, error emitting api (rust_error?), in order to input tokens and process them.</p>
<p>The tests would consist of different scenarios of token streams from valid rust files and the parser should be able to capture all the necessary information from the token streams. For testing, the programmer should consult <a href="https://www.gnu.org/software/dejagnu/manual/index.html" rel="nofollow" target="_blank">https://www.gnu.org/software/dejagnu/manual/index.html</a> and look at relevant test suites</p>
<p>One inspiration for this part would be <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_codegen_gcc/src/asm.rs" rel="nofollow" target="_blank">rustc_codegen_gcc/asm.rs</a> to see how the project translates rust inline assembly to gcc inline assembly IR (IR here represents the result after the parser has finished parsing it and the semantics have been transformed (per the <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_codegen_gcc/src/asm.rs" rel="nofollow" target="_blank">asm.rs</a> file's comment) and later can be used solely to generate code).</p>
<p>Another one is since rust asm uses formatting with arg, it will be helpful to consider  <a href="https://github.com/rust-lang/rust/blob/master/compiler/rustc_parse_format/src/lib.rs" rel="nofollow" target="_blank">https://github.com/rust-lang/rust/blob/master/compiler/rustc_parse_format/src/lib.rs</a> and see how they work with the formatting logic.</p>
<h3 id="week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor"><a aria-hidden="true" tabindex="-1" href="#week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor"><span class="icon icon-link"></span></a>WEEK 4 (June 17 - June 24): Improve (if possible) asm-AST in rust-macro-builtins, implement asm-HIR and visitor</h3>
<p>From <a href="https://github.com/Rust-GCC/gccrs/issues/1566" rel="nofollow" target="_blank">Rust-GCC/gccrs#1566</a>, asm-AST has already been implemented, I am to implement asm-HIR and its visitor instead.</p>
<p>The AST (Abstract syntax tree) is the result of the Rust Inline Assembly Parser. This AST will be transformed to a HIR (High Level Intermediate Representation) through a process called <code>Lowering.</code> This IR helps us perform multiple syntax desugaring, as well as type-checking or borrow checking through the uses of its visitors.</p>
<p>This subpart is done after parsing so that we know what our asm-HIR needs from the parser.</p>
<p>Testing-wise, I’m not sure there is any testing to be done for this part.</p>
<h3 id="week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens"><a aria-hidden="true" tabindex="-1" href="#week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens"><span class="icon icon-link"></span></a>WEEK 5 (June 24 - July 1): Implement handlers for asm, creating AST asm from a stream of tokens.</h3>
<p>From the available parser, I can use it in conjunction with asm-nodes and asm-AST in rust-macro-builtsin, outputing the asm-AST that I have declared and defined.</p>
<p>No testing on this part.</p>
<h3 id="week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir"><a aria-hidden="true" tabindex="-1" href="#week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir"><span class="icon icon-link"></span></a>WEEK 6-7 (July 1 - July 15): Work with ASTLowering, lowering the asm-AST to HIR (high level IR).</h3>
<p>The main classes to deal with are ASTLowering* in the gcc/rust/hir folder. I would create a new class inheriting from ASTLoweringBase and a constructor from asm-AST to deal with lowering the asm-AST.</p>
<h3 id="week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language"><a aria-hidden="true" tabindex="-1" href="#week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language"><span class="icon icon-link"></span></a>WEEK 7-8 (July 15 - July 29): Work with GENERIC IL in Compile*, converting HIR to GENERIC intermediate language.</h3>
<p>The calls to express and create GENERIC tree will be provided via gcc/tree.def. For this part, some helpful definitions are present in gcc/c/c-typeck.cc</p>
<h3 id="week-9-july-29---aug-5-end-to-end-testing"><a aria-hidden="true" tabindex="-1" href="#week-9-july-29---aug-5-end-to-end-testing"><span class="icon icon-link"></span></a>WEEK 9 (July 29 - Aug 5): End-to-end testing.</h3>
<p>Introduce end-to-end testing and fix all relevant bugs.</p>
<p>The required testing involves testing existing inline assembly invocations taken directly from the Rust standard library, as well as testcases from rustc.</p>
<h3 id="week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects"><a aria-hidden="true" tabindex="-1" href="#week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects"><span class="icon icon-link"></span></a>WEEK 11-12 (Aug 5 - 19): Spare time allocation for different parts of projects.</h3>
<p>2 week of free time will be allocated to different aspect of the project.</p>
<h3 id="week-10-aug-19---aug-26-report-and-documentation"><a aria-hidden="true" tabindex="-1" href="#week-10-aug-19---aug-26-report-and-documentation"><span class="icon icon-link"></span></a>WEEK 10 (Aug 19 - Aug 26): Report and Documentation</h3>
<p>I will finish up my report and documentation before submission of my project.</p>
<h2 id="responsibitiles-and-my-schedule"><a aria-hidden="true" tabindex="-1" href="#responsibitiles-and-my-schedule"><span class="icon icon-link"></span></a>Responsibitiles and my schedule.</h2>
<h3 id="university"><a aria-hidden="true" tabindex="-1" href="#university"><span class="icon icon-link"></span></a>University</h3>
<p>My university spring semester ends on Friday, May 10, 2024 with my final exam on May 9.</p>
<p>My university fall semester usually begins on August 23.</p>
<p>My fall semester coursework will (likely) be:</p>
<ul>
<li>CS 265. Compiler Optimization and Code Generation (3 Units) (Grad)</li>
<li>CS 189: Introduction to Machine Learning (4 Units) (Ugrad)</li>
<li>CS 170: Efficient Algorithms and Intractable Problems (4 Units) (Ugrad)</li>
</ul>
<h3 id="internship"><a aria-hidden="true" tabindex="-1" href="#internship"><span class="icon icon-link"></span></a>Internship</h3>
<p>I have an offer where the starting date will be end of May - early June and the ending date will be on the second week of August.</p>
<p>I will be working on the project over the course of May to August 26.</p>
<p>If I am unable to complete the project's goals, I will make sure to discuss an extension with my mentors at the earliest possible.</p>
<p>Such detailed timeline coupled with comprehensive design document is to ensure my progress is consistent throughout.</p>
<h1 id="design-doc"><a aria-hidden="true" tabindex="-1" href="#design-doc"><span class="icon icon-link"></span></a>Design doc</h1>
<p>The design doc is to help me plan out ahead my implementation and discuss them with my mentor.</p>
<h2 id="lexer--parser-implementation"><a aria-hidden="true" tabindex="-1" href="#lexer--parser-implementation"><span class="icon icon-link"></span></a>Lexer &#x26; Parser implementation</h2>
<h3 id="grammar"><a aria-hidden="true" tabindex="-1" href="#grammar"><span class="icon icon-link"></span></a>Grammar</h3>
<p>The BNF grammar for the inline assembly is</p>
<pre><code>format_string := STRING_LITERAL / RAW_STRING_LITERAL
dir_spec := "in" / "out" / "lateout" / "inout" / "inlateout"
reg_spec := &#x3C;register class> / "\"" &#x3C;explicit register> "\""
operand_expr := expr / "_" / expr "=>" expr / expr "=>" "_"
reg_operand := [ident "="] dir_spec "(" reg_spec ")" operand_expr
clobber_abi := "clobber_abi(" &#x3C;abi> *("," &#x3C;abi>) [","] ")"
option := "pure" / "nomem" / "readonly" / "preserves_flags" /
        "noreturn" / "nostack" / "att_syntax" / "raw"
options := "options(" option *("," option) [","] ")"
operand := reg_operand / clobber_abi / options
asm := "asm!(" format_string *("," format_string)
    *("," operand) [","] ")"
global_asm := "global_asm!(" format_string
    *("," format_string) *("," operand) [","] ")"

end := asm | global_asm
</code></pre>
<p>where the end result will be an <code>end</code>.</p>
<h3 id="implementation"><a aria-hidden="true" tabindex="-1" href="#implementation"><span class="icon icon-link"></span></a>Implementation</h3>
<p>The lexer I'll be using on this part will be the <code>MacroInvocLexer</code> via <code>MacroInvocLexer lex (invoc.get_delim_tok_tree ().to_token_stream ());</code>. It serves as a parameter for my parser like
<code>Parser&#x3C;MacroInvocLexer> parser (lex);</code></p>
<p>With the parser called <code>p</code>, I can call the methods in <code>gcc/rust/parse/rust-parse.h</code> on the parser to perform some recursive descent logic.</p>
<h2 id="rust-asm-ast-hir-and-visitor"><a aria-hidden="true" tabindex="-1" href="#rust-asm-ast-hir-and-visitor"><span class="icon icon-link"></span></a>rust asm-ast, HIR, and visitor</h2>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#737994;font-style:italic">// Namespace HIR</span></span>
<span class="line"><span style="color:#737994;font-style:italic">// In rust-hir-exp.h</span></span>
<span class="line"><span style="color:#C6D0F5">InlineAsm : ExprWithoutBlock </span><span style="color:#949CBB">{</span></span>
<span class="line"><span style="color:#C6D0F5">    ...</span></span>
<span class="line"><span style="color:#949CBB">}</span></span>
<span class="line"></span>
<span class="line"><span style="color:#737994;font-style:italic">// in rust-hir.cc</span></span>
<span class="line"><span style="color:#CA9EE6">void</span><span style="color:#E5C890"> InlineAsm</span><span style="color:#949CBB">::</span><span style="color:#8CAAEE;font-style:italic">accept</span><span style="color:#949CBB">(</span><span style="color:#E5C890;font-style:italic">HIRExpressionVisitor</span><span style="color:#81C8BE"> &#x26;</span><span style="color:#EA999C;font-style:italic">vis</span><span style="color:#949CBB">)</span><span style="color:#949CBB"> {</span></span>
<span class="line"><span style="color:#C6D0F5">    vis</span><span style="color:#949CBB">.</span><span style="color:#8CAAEE;font-style:italic">visit</span><span style="color:#949CBB"> (</span><span style="color:#81C8BE">*</span><span style="color:#E78284">this</span><span style="color:#949CBB">);</span></span>
<span class="line"><span style="color:#949CBB">}</span></span></code></pre>
<p>The visitor for HIR::InlineAsm is HIRExpressionVisitor.</p>
<h2 id="asm-handlers"><a aria-hidden="true" tabindex="-1" href="#asm-handlers"><span class="icon icon-link"></span></a>asm-handlers</h2>
<p>I need to add two entries which are the handler functions to the <code>gcc/rust/expand/rust-macro-builtins.cc</code>'s <code>MacroBuiltin::builtin_transcribers</code> and remove the <code>llvm_asm</code> key from the map.</p>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#949CBB">{</span><span style="color:#A6D189">"asm"</span><span style="color:#949CBB">,</span><span style="color:#E5C890"> MacroBuiltin</span><span style="color:#949CBB">::</span><span style="color:#C6D0F5">asm_handler</span><span style="color:#949CBB">},</span></span>
<span class="line"><span style="color:#949CBB">{</span><span style="color:#A6D189">"llvm_asm"</span><span style="color:#949CBB">,</span><span style="color:#E5C890"> MacroBuiltin</span><span style="color:#949CBB">::</span><span style="color:#C6D0F5">sorry</span><span style="color:#949CBB">},</span><span style="color:#737994;font-style:italic"> // Remove this.</span></span>
<span class="line"><span style="color:#949CBB">{</span><span style="color:#A6D189">"global_asm"</span><span style="color:#949CBB">,</span><span style="color:#E5C890"> MacroBuiltin</span><span style="color:#949CBB">::</span><span style="color:#C6D0F5">global_asm_handler</span><span style="color:#949CBB">},</span></span></code></pre>
<p>I also need to define the two handlers in <code>gcc/rust/expand/rust-macro-builtins.h</code>. They both will</p>
<ul>
<li>Call the parser I implement in the previous part, get the AST::asm from it.</li>
<li>Transform the <code>AST::asm</code> node to an <code>AST::Fragment</code></li>
<li>Return the <code>AST::Fragment</code>.</li>
</ul>
<p>An <code>AST::Fragment</code> is an AST that can be incorporated back to the AST produced by the general parser. The main reasoning for not returning the <code>AST::asm</code> but instead opting for <code>AST::Fragment</code> is because of the process described by <a href="https://github.com/rust-lang/rustc-dev-guide/blob/master/src/macro-expansion.md" rel="nofollow" target="_blank">https://github.com/rust-lang/rustc-dev-guide/blob/master/src/macro-expansion.md</a></p>
<h2 id="astlowering"><a aria-hidden="true" tabindex="-1" href="#astlowering"><span class="icon icon-link"></span></a>ASTLowering</h2>
<h2 id="converting-hir-to-generic-intermediate-language"><a aria-hidden="true" tabindex="-1" href="#converting-hir-to-generic-intermediate-language"><span class="icon icon-link"></span></a>Converting HIR to GENERIC intermediate language</h2>
<p>Document for GENERIC asm is at <a href="https://gcc.gnu.org/onlinedocs/gccint/Basic-Statements.html" rel="nofollow" target="_blank">GENERIC</a>.</p>
<p>In gcc/c/c-typeck.cc, there is the provided build_asm_expr which I can use to generate GENERIC</p>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#C6D0F5">tree</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">build_asm_expr</span><span style="color:#949CBB"> (</span><span style="color:#E5C890;font-style:italic">location_t</span><span style="color:#EA999C;font-style:italic"> loc</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> tree </span><span style="color:#EA999C;font-style:italic">string</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> tree </span><span style="color:#EA999C;font-style:italic">outputs</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> tree </span><span style="color:#EA999C;font-style:italic">inputs</span><span style="color:#949CBB">,</span></span>
<span class="line"><span style="color:#C6D0F5">		tree </span><span style="color:#EA999C;font-style:italic">clobbers</span><span style="color:#949CBB">,</span><span style="color:#C6D0F5"> tree </span><span style="color:#EA999C;font-style:italic">labels</span><span style="color:#949CBB">,</span><span style="color:#CA9EE6"> bool</span><span style="color:#EA999C;font-style:italic"> simple</span><span style="color:#949CBB">,</span><span style="color:#CA9EE6"> bool</span><span style="color:#EA999C;font-style:italic"> is_inline</span><span style="color:#949CBB">);</span></span></code></pre>
<p>There are also some macro definitions in <code>gcc/tree.h</code> that are helpful in manipulating tree expr.</p>
<p>For example, from line 1381 to 1385</p>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#737994;font-style:italic">/* ASM_EXPR accessors. ASM_STRING returns a STRING_CST for the</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   instruction (e.g., "mov x, y"). ASM_OUTPUTS, ASM_INPUTS, and</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   ASM_CLOBBERS represent the outputs, inputs, and clobbers for the</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   statement.  */</span></span>
<span class="line"><span style="color:#E5C890">#define</span><span style="color:#8CAAEE;font-style:italic"> ASM_STRING</span><span style="color:#949CBB">(</span><span style="color:#EA999C;font-style:italic">NODE</span><span style="color:#949CBB">)</span><span style="color:#8CAAEE;font-style:italic">        TREE_OPERAND</span><span style="color:#949CBB"> (</span><span style="color:#8CAAEE;font-style:italic">ASM_EXPR_CHECK</span><span style="color:#949CBB"> (</span><span style="color:#C6D0F5">NODE</span><span style="color:#949CBB">),</span><span style="color:#EF9F76"> 0</span><span style="color:#949CBB">)</span></span>
<span class="line"><span style="color:#E5C890">#define</span><span style="color:#8CAAEE;font-style:italic"> ASM_OUTPUTS</span><span style="color:#949CBB">(</span><span style="color:#EA999C;font-style:italic">NODE</span><span style="color:#949CBB">)</span><span style="color:#8CAAEE;font-style:italic">       TREE_OPERAND</span><span style="color:#949CBB"> (</span><span style="color:#8CAAEE;font-style:italic">ASM_EXPR_CHECK</span><span style="color:#949CBB"> (</span><span style="color:#C6D0F5">NODE</span><span style="color:#949CBB">),</span><span style="color:#EF9F76"> 1</span><span style="color:#949CBB">)</span></span>
<span class="line"><span style="color:#E5C890">#define</span><span style="color:#8CAAEE;font-style:italic"> ASM_INPUTS</span><span style="color:#949CBB">(</span><span style="color:#EA999C;font-style:italic">NODE</span><span style="color:#949CBB">)</span><span style="color:#8CAAEE;font-style:italic">        TREE_OPERAND</span><span style="color:#949CBB"> (</span><span style="color:#8CAAEE;font-style:italic">ASM_EXPR_CHECK</span><span style="color:#949CBB"> (</span><span style="color:#C6D0F5">NODE</span><span style="color:#949CBB">),</span><span style="color:#EF9F76"> 2</span><span style="color:#949CBB">)</span></span>
<span class="line"><span style="color:#E5C890">#define</span><span style="color:#8CAAEE;font-style:italic"> ASM_CLOBBERS</span><span style="color:#949CBB">(</span><span style="color:#EA999C;font-style:italic">NODE</span><span style="color:#949CBB">)</span><span style="color:#8CAAEE;font-style:italic">      TREE_OPERAND</span><span style="color:#949CBB"> (</span><span style="color:#8CAAEE;font-style:italic">ASM_EXPR_CHECK</span><span style="color:#949CBB"> (</span><span style="color:#C6D0F5">NODE</span><span style="color:#949CBB">),</span><span style="color:#EF9F76"> 3</span><span style="color:#949CBB">)</span></span>
<span class="line"><span style="color:#E5C890">#define</span><span style="color:#8CAAEE;font-style:italic"> ASM_LABELS</span><span style="color:#949CBB">(</span><span style="color:#EA999C;font-style:italic">NODE</span><span style="color:#949CBB">)</span><span style="color:#8CAAEE;font-style:italic">	    TREE_OPERAND</span><span style="color:#949CBB"> (</span><span style="color:#8CAAEE;font-style:italic">ASM_EXPR_CHECK</span><span style="color:#949CBB"> (</span><span style="color:#C6D0F5">NODE</span><span style="color:#949CBB">),</span><span style="color:#EF9F76"> 4</span><span style="color:#949CBB">)</span></span></code></pre>
<p>Another point worth mentioning that since these ASM accessors are nothing but STRING_CST, it would be helpful to be able to determine how to build a STRING_CST. The detailed documentation in <code>gcc/tree.cc</code> is:</p>
<pre class="shiki catppuccin-frappe" style="background-color:#303446;color:#c6d0f5" tabindex="0"><code><span class="line"><span style="color:#737994;font-style:italic">/* Return a newly constructed STRING_CST node whose value is the LEN</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   characters at STR when STR is nonnull, or all zeros otherwise.</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   Note that for a C string literal, LEN should include the trailing NUL.</span></span>
<span class="line"><span style="color:#737994;font-style:italic">   The TREE_TYPE is not initialized.  */</span></span>
<span class="line"></span>
<span class="line"><span style="color:#C6D0F5">tree</span></span>
<span class="line"><span style="color:#8CAAEE;font-style:italic">build_string</span><span style="color:#949CBB"> (</span><span style="color:#CA9EE6">unsigned</span><span style="color:#EA999C;font-style:italic"> len</span><span style="color:#949CBB">,</span><span style="color:#CA9EE6"> const</span><span style="color:#CA9EE6"> char</span><span style="color:#81C8BE"> *</span><span style="color:#C6D0F5">str</span><span style="color:#737994;font-style:italic"> /*= NULL */</span><span style="color:#949CBB">)</span><span style="color:#949CBB"> {</span><span style="color:#C6D0F5">...</span><span style="color:#949CBB">}</span></span></code></pre>
<h1 id="introduce-myself-my-skills-and-accomplishments"><a aria-hidden="true" tabindex="-1" href="#introduce-myself-my-skills-and-accomplishments"><span class="icon icon-link"></span></a>Introduce myself, my skills and accomplishments</h1>
<h2 id="information"><a aria-hidden="true" tabindex="-1" href="#information"><span class="icon icon-link"></span></a>Information</h2>
<p>Name: Jasmine Tang</p>
<p>Email (personal): <a href="mailto:tanghocle456@gmail.com">tanghocle456@gmail.com</a></p>
<p>Email (personal): <a href="mailto:thisisjjasmine@gmail.com">thisisjjasmine@gmail.com</a></p>
<p>Email (University): <a href="mailto:jjasmine@berkeley.edu">jjasmine@berkeley.edu</a></p>
<p>GitHub: <a href="https://github.com/badumbatish" rel="nofollow" target="_blank">badumbatish</a></p>
<p>Resume (continually updated): <a href="https://www.overleaf.com/read/bzvddqdhfdqp#fb6509" rel="nofollow" target="_blank">https://www.overleaf.com/read/bzvddqdhfdqp#fb6509</a></p>
<p>University: University of California Berkeley</p>
<h2 id="about-myself"><a aria-hidden="true" tabindex="-1" href="#about-myself"><span class="icon icon-link"></span></a>About myself</h2>
<p>Hi everyone, I’m Jasmine. I’m currently a junior undergraduate at UC Berkeley majoring in EECS. This semester, I am taking an undergraduate compiler and will be taking a grad class about code optimization this upcoming Fall.</p>
<p>I’ve been programming in C, C++, Python, Java, Rust, mainly C/C++ and have done projects in relation to C++ and compilers</p>
<p>Regarding compilers,  one of my projects include building a Scheme (Lisp dialect) Interpreter with recursive descent parsing in Python. As a semester-long class project, I am also building a ChocoPy compiler (a statically-typed subset of Python) with Java’s lexer and Java’s LALR(1) parser generator, writing passes for semantic checking and type-checking, as well as generating RISC-V assembly code. I just recently finished the LLVM’s Kaleidoscope tutorial and am trying to refactor the LLVM-based compiler as my own hobby project; currently I have gotten lexing and parsing refactored.</p>
<p>I’ve also done a number of projects related to C/C++. Some includes reimplementing std::vector with the standard allocator. As another semester-long class project, I’m working on PintOS, an educational operating system, adding support for syscalls, multiprocessing and multithreading and file systems.</p>
<h2 id="my-contribution-to-gccrs"><a aria-hidden="true" tabindex="-1" href="#my-contribution-to-gccrs"><span class="icon icon-link"></span></a>My contribution to gccrs</h2>
<p>I want to preface this by saying all of this contribution would not be possible if not for my potential mentor Arthur.</p>
<p>I joined gccrs' Zulip channel in late febuary / early March and since have put in some pull requests for the repository as well as contributed an ARM-based Ubuntu Docker image tailored to development of gccrs with persistent storage settings and different hotswappable versions of the image via docker compose at <a href="https://github.com/badumbatish/gccrs-workspace" rel="nofollow" target="_blank">https://github.com/badumbatish/gccrs-workspace</a>.</p>
<p>My first contribution was adding tl::optional typing to MacroBuiltin map, a data structure I need to familiar with for this project.</p>
<p>The second contribution was to refactor all macro handlers into different themes to ease navigation and development.</p>
<p>For the third and fourth one, I fixed a error emitting bug when late-resolving an id expression and fixed visibility storage from parsing ExternalTypeItem until HIR construction.</p>
<p>Please feel free to see a list of my pull requests to gccrs at <a href="https://github.com/Rust-GCC/gccrs/pulls?q=is%3Apr+author%3Abadumbatish+" rel="nofollow" target="_blank">https://github.com/Rust-GCC/gccrs/pulls?q=is%3Apr+author%3Abadumbatish+</a></p>
<p>or by putting <code>is:pr author:badumbatish</code> in the pull request search bar.</p>
<p>or by selecting <code>badumbatish</code> as author in mobile.</p></div></article></div></div><button class="bottom-4 right-4 fixed"><div class="inline text-2xl font-bold border-black border-2 rounded  p-0 m-0 h-100 w-100">⇡⇡</div></button><footer class="footer self-center justify-center gap-2 pt-4 items-center italic "><p>I&#x27;m looking for new grad compiler work, please email at jjasmine@berkeley.edu</p><p>Built by Jasmine with NextJS, TailwindCSS, and a tonnn of loveee :)</p></footer><script src="/_next/static/chunks/webpack-a3e322df7e912d9b.js" async=""></script><script>(self.__next_f=self.__next_f||[]).push([0])</script><script>self.__next_f.push([1,"1:\"$Sreact.fragment\"\n2:I[8173,[\"173\",\"static/chunks/173-ad05a37061268ac6.js\",\"880\",\"static/chunks/app/posts/%5Bid%5D/page-0a046863f2056281.js\"],\"\"]\n3:I[5244,[],\"\"]\n4:I[3866,[],\"\"]\n5:I[1168,[\"173\",\"static/chunks/173-ad05a37061268ac6.js\",\"565\",\"static/chunks/565-d3001cb0b7ac580c.js\",\"177\",\"static/chunks/app/layout-23d97ae8d15fbd69.js\"],\"default\"]\n7:I[6213,[],\"OutletBoundary\"]\n9:I[6213,[],\"MetadataBoundary\"]\nb:I[6213,[],\"ViewportBoundary\"]\nd:I[4835,[],\"\"]\n:HL[\"/_next/static/media/7385e8d9d3c5518f-s.p.ttf\",\"font\",{\"crossOrigin\":\"\",\"type\":\"font/ttf\"}]\n:HL[\"/_next/static/css/c964a4de8175fdfc.css\",\"style\"]\n:HL[\"/_next/static/css/7ad14cf05ba66ef7.css\",\"style\"]\n"])</script><script>self.__next_f.push([1,"0:{\"P\":null,\"b\":\"YP_-mP8_gKSAyA_5ulzg2\",\"p\":\"\",\"c\":[\"\",\"posts\",\"gsoc_prop\"],\"i\":false,\"f\":[[[\"\",{\"children\":[\"posts\",{\"children\":[[\"id\",\"gsoc_prop\",\"d\"],{\"children\":[\"__PAGE__\",{}]}]}]},\"$undefined\",\"$undefined\",true],[\"\",[\"$\",\"$1\",\"c\",{\"children\":[[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/c964a4de8175fdfc.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"html\",null,{\"lang\":\"en\",\"className\":\"px-4 py-4\",\"children\":[\"$\",\"body\",null,{\"className\":\"__className_d4e0c8 flex flex-col min-h-screen\",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/\",\"children\":[\"$\",\"div\",null,{\"className\":\"flex justify-center items-center py-4 \",\"children\":[\"$\",\"h1\",null,{\"className\":\"text-4xl font-bold\",\"children\":\"Jasmine Tang\"}]}]}],[\"$\",\"div\",null,{\"className\":\"flex-1\",\"children\":[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":[[],[[\"$\",\"title\",null,{\"children\":\"404: This page could not be found.\"}],[\"$\",\"div\",null,{\"style\":{\"fontFamily\":\"system-ui,\\\"Segoe UI\\\",Roboto,Helvetica,Arial,sans-serif,\\\"Apple Color Emoji\\\",\\\"Segoe UI Emoji\\\"\",\"height\":\"100vh\",\"textAlign\":\"center\",\"display\":\"flex\",\"flexDirection\":\"column\",\"alignItems\":\"center\",\"justifyContent\":\"center\"},\"children\":[\"$\",\"div\",null,{\"children\":[[\"$\",\"style\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"body{color:#000;background:#fff;margin:0}.next-error-h1{border-right:1px solid rgba(0,0,0,.3)}@media (prefers-color-scheme:dark){body{color:#fff;background:#000}.next-error-h1{border-right:1px solid rgba(255,255,255,.3)}}\"}}],[\"$\",\"h1\",null,{\"className\":\"next-error-h1\",\"style\":{\"display\":\"inline-block\",\"margin\":\"0 20px 0 0\",\"padding\":\"0 23px 0 0\",\"fontSize\":24,\"fontWeight\":500,\"verticalAlign\":\"top\",\"lineHeight\":\"49px\"},\"children\":404}],[\"$\",\"div\",null,{\"style\":{\"display\":\"inline-block\"},\"children\":[\"$\",\"h2\",null,{\"style\":{\"fontSize\":14,\"fontWeight\":400,\"lineHeight\":\"49px\",\"margin\":0},\"children\":\"This page could not be found.\"}]}]]}]}]]],\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]}],[\"$\",\"$L5\",null,{}],[\"$\",\"footer\",null,{\"className\":\"footer self-center justify-center gap-2 pt-4 items-center italic \",\"children\":[[\"$\",\"p\",null,{\"children\":\"I'm looking for new grad compiler work, please email at jjasmine@berkeley.edu\"}],[\"$\",\"p\",null,{\"children\":\"Built by Jasmine with NextJS, TailwindCSS, and a tonnn of loveee :)\"}]]}]]}]}]]}],{\"children\":[\"posts\",[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[[\"id\",\"gsoc_prop\",\"d\"],[\"$\",\"$1\",\"c\",{\"children\":[null,[\"$\",\"$L3\",null,{\"parallelRouterKey\":\"children\",\"segmentPath\":[\"children\",\"posts\",\"children\",\"$0:f:0:1:2:children:2:children:0\",\"children\"],\"error\":\"$undefined\",\"errorStyles\":\"$undefined\",\"errorScripts\":\"$undefined\",\"template\":[\"$\",\"$L4\",null,{}],\"templateStyles\":\"$undefined\",\"templateScripts\":\"$undefined\",\"notFound\":\"$undefined\",\"forbidden\":\"$undefined\",\"unauthorized\":\"$undefined\"}]]}],{\"children\":[\"__PAGE__\",[\"$\",\"$1\",\"c\",{\"children\":[\"$L6\",[[\"$\",\"link\",\"0\",{\"rel\":\"stylesheet\",\"href\":\"/_next/static/css/7ad14cf05ba66ef7.css\",\"precedence\":\"next\",\"crossOrigin\":\"$undefined\",\"nonce\":\"$undefined\"}]],[\"$\",\"$L7\",null,{\"children\":\"$L8\"}]]}],{},null,false]},null,false]},null,false]},null,false],[\"$\",\"$1\",\"h\",{\"children\":[null,[\"$\",\"$1\",\"eLtDVqsk04-H1WNt-6n8L\",{\"children\":[[\"$\",\"$L9\",null,{\"children\":\"$La\"}],[\"$\",\"$Lb\",null,{\"children\":\"$Lc\"}],[\"$\",\"meta\",null,{\"name\":\"next-size-adjust\",\"content\":\"\"}]]}]]}],false]],\"m\":\"$undefined\",\"G\":[\"$d\",\"$undefined\"],\"s\":false,\"S\":true}\n"])</script><script>self.__next_f.push([1,"c:[[\"$\",\"meta\",\"0\",{\"name\":\"viewport\",\"content\":\"width=device-width, initial-scale=1\"}]]\n"])</script><script>self.__next_f.push([1,"e:T9321,"])</script><script>self.__next_f.push([1,"\u003cnav class=\"toc\"\u003e\u003col class=\"toc-level toc-level-1\"\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#prologue\"\u003ePrologue\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#jjasmines-gsoc-gccrs-proposal\"\u003ejjasmine’s Gsoc GCCRS proposal\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#gsoc-proposal-inline-assembly-support\"\u003eGsoc Proposal: Inline assembly Support\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#project\"\u003eProject\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#goals\"\u003eGoals\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#expected-timeline--responsibitilies\"\u003eExpected timeline \u0026#x26; responsibitilies\u003c/a\u003e\u003col class=\"toc-level toc-level-2\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#expected-timeline\"\u003eExpected timeline\u003c/a\u003e\u003col class=\"toc-level toc-level-3\"\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format\"\u003eWEEK 1-3 (May 27 - June 17): Implement and test the parser to convert rust asm format to gcc asm format.\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor\"\u003eWEEK 4 (June 17 - June 24): Improve (if possible) asm-AST in rust-macro-builtins, implement asm-HIR and visitor\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens\"\u003eWEEK 5 (June 24 - July 1): Implement handlers for asm, creating AST asm from a stream of tokens.\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir\"\u003eWEEK 6-7 (July 1 - July 15): Work with ASTLowering, lowering the asm-AST to HIR (high level IR).\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language\"\u003eWEEK 7-8 (July 15 - July 29): Work with GENERIC IL in Compile*, converting HIR to GENERIC intermediate language.\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-9-july-29---aug-5-end-to-end-testing\"\u003eWEEK 9 (July 29 - Aug 5): End-to-end testing.\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects\"\u003eWEEK 11-12 (Aug 5 - 19): Spare time allocation for different parts of projects.\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#week-10-aug-19---aug-26-report-and-documentation\"\u003eWEEK 10 (Aug 19 - Aug 26): Report and Documentation\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#responsibitiles-and-my-schedule\"\u003eResponsibitiles and my schedule.\u003c/a\u003e\u003col class=\"toc-level toc-level-3\"\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#university\"\u003eUniversity\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#internship\"\u003eInternship\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#design-doc\"\u003eDesign doc\u003c/a\u003e\u003col class=\"toc-level toc-level-2\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#lexer--parser-implementation\"\u003eLexer \u0026#x26; Parser implementation\u003c/a\u003e\u003col class=\"toc-level toc-level-3\"\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#grammar\"\u003eGrammar\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h3\"\u003e\u003ca class=\"toc-link toc-link-h3\" href=\"#implementation\"\u003eImplementation\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#rust-asm-ast-hir-and-visitor\"\u003erust asm-ast, HIR, and visitor\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#asm-handlers\"\u003easm-handlers\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#astlowering\"\u003eASTLowering\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#converting-hir-to-generic-intermediate-language\"\u003eConverting HIR to GENERIC intermediate language\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h1\"\u003e\u003ca class=\"toc-link toc-link-h1\" href=\"#introduce-myself-my-skills-and-accomplishments\"\u003eIntroduce myself, my skills and accomplishments\u003c/a\u003e\u003col class=\"toc-level toc-level-2\"\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#information\"\u003eInformation\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#about-myself\"\u003eAbout myself\u003c/a\u003e\u003c/li\u003e\u003cli class=\"toc-item toc-item-h2\"\u003e\u003ca class=\"toc-link toc-link-h2\" href=\"#my-contribution-to-gccrs\"\u003eMy contribution to gccrs\u003c/a\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/li\u003e\u003c/ol\u003e\u003c/nav\u003e\u003ch1 id=\"prologue\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#prologue\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003ePrologue\u003c/h1\u003e\n\u003cp\u003eHi everyone, I hope you're doing great. This is an archive of my GSoc 2024 proposal: Inline Assembly in gccrs.\u003c/p\u003e\n\u003cp\u003eAlso here's a \u003ca href=\"https://www.youtube.com/watch?v=hSYfVjRMeis\u0026#x26;ab_channel=darkcat-Topic\" rel=\"nofollow\" target=\"_blank\"\u003esong\u003c/a\u003e for you :)\u003c/p\u003e\n\u003cp\u003eI hope\nyou enjoy!\u003c/p\u003e\n\u003ch1 id=\"jjasmines-gsoc-gccrs-proposal\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#jjasmines-gsoc-gccrs-proposal\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003ejjasmine’s Gsoc GCCRS proposal\u003c/h1\u003e\n\u003ch1 id=\"gsoc-proposal-inline-assembly-support\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#gsoc-proposal-inline-assembly-support\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eGsoc Proposal: Inline assembly Support\u003c/h1\u003e\n\u003ch1 id=\"project\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#project\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eProject\u003c/h1\u003e\n\u003cp\u003eFrom the gccrs github, \"gccrs is a full alternative implementation of the Rust language ontop of GCC with the goal to become fully upstream with the GNU toolchain.\"\u003c/p\u003e\n\u003cp\u003eOne of the steps to reach its implementation counterpart's parity (rustc) is the support of inline assembly. Enabling this feature allows programmers to work on low level situation where some extra performance is always needed.\u003c/p\u003e\n\u003cp\u003eAn example is where you would want to handle the case of moving 16-bit data when the data is not exactly 64-bit.\u003c/p\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// https://github.com/rust-lang/rust/blob/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// b3df0d7e5ef5f7dbeeca3fb289c65680ad013f87/library/std/src/sys/pal/sgx/abi/\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// usercalls/alloc.rs#L330\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#CA9EE6\"\u003eunsafe\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e fn\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e copy_quadwords\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C\"\u003esrc\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e *\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003econst\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e u8\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#EA999C\"\u003e dst\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e *\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003emut\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e u8\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#EA999C\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e:\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e usize\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#CA9EE6\"\u003e    unsafe\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e        asm!\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#A6D189\"\u003e            \"rep movsq (%rsi), (%rdi)\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e            inout\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"rcx\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e len \u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e/\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 8\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e =\u003e\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e _\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e            inout\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"rdi\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e dst \u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e _\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e            inout\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"rsi\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e src \u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e=\u003e\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e _\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e            options\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eatt_syntax\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e nostack\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e preserves_flags\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e        );\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e    }\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe project focuses on adding implementation for two built-in Rust macros: \u003ccode\u003easm!()\u003c/code\u003e, and \u003ccode\u003eglobal_asm!()\u003c/code\u003e.\u003c/p\u003e\n\u003cp\u003eThe gcc compiler will be able to detect parse the assembly code within asm!, and global_asm! macro, converting them to gcc assembly format to eventually generate code.\u003c/p\u003e\n\u003ch1 id=\"goals\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#goals\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eGoals\u003c/h1\u003e\n\u003cp\u003eThis work will require modifications to multiple parts of our compiler, with the creation of built-in macro expanders, AST nodes, HIR nodes, as well as the development of a Rust inline-assembly parser to then convert it to the GCC inline assembly format:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eDevelop a Rust inline assembly parser.\u003c/li\u003e\n\u003cli\u003eImprove AST inline assembly node.\u003c/li\u003e\n\u003cli\u003eConstruct HIR inline assembly node.\u003c/li\u003e\n\u003cli\u003eConstruct HIR node visitor for the Lowering process.\u003c/li\u003e\n\u003cli\u003eImplement the HIR -\u003e Generic IL process for inline assembly HIR nodes.\u003c/li\u003e\n\u003cli\u003eEnd to test testing of the new gccrs compiler for parity with rustc\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch1 id=\"expected-timeline--responsibitilies\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#expected-timeline--responsibitilies\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eExpected timeline \u0026#x26; responsibitilies\u003c/h1\u003e\n\u003cp\u003eThe project (coding aspect) is classified as 175 hours (medium) spanning from May 27 to August 26 (3 months or 12 weeks). This equates to 175/12 = 14.58 hours per week, or 2 hours per day.\u003c/p\u003e\n\u003cp\u003eThe first subsection serves as a mini design doc where I explain my timeline and expand to my implementation goals.\u003c/p\u003e\n\u003cp\u003eThe second subsection goes over my schedule and other responsibilities I have over summer and how I plan to counteract that.\u003c/p\u003e\n\u003ch2 id=\"expected-timeline\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#expected-timeline\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eExpected timeline\u003c/h2\u003e\n\u003ch3 id=\"week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-1-3-may-27---june-17-implement-and-test-the-parser-to-convert-rust-asm-format-to-gcc-asm-format\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 1-3 (May 27 - June 17): Implement and test the parser to convert rust asm format to gcc asm format.\u003c/h3\u003e\n\u003cp\u003eSince Rust follows a different convention in calling its assembly than C/C++, I need to parse and capture the information so that in later stages, I can use the information as arguments into one of gcc’s available function call regarding inline assembly.\nThe parser will be a recursive-descent parser, adhering to the ABNF syntax described at \u003ca href=\"https://doc.rust-lang.org/reference/inline-assembly.html\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://doc.rust-lang.org/reference/inline-assembly.html\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eThe programmer (me in this case) will need to learn about gccrs’ token stream API, error emitting api (rust_error?), in order to input tokens and process them.\u003c/p\u003e\n\u003cp\u003eThe tests would consist of different scenarios of token streams from valid rust files and the parser should be able to capture all the necessary information from the token streams. For testing, the programmer should consult \u003ca href=\"https://www.gnu.org/software/dejagnu/manual/index.html\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.gnu.org/software/dejagnu/manual/index.html\u003c/a\u003e and look at relevant test suites\u003c/p\u003e\n\u003cp\u003eOne inspiration for this part would be \u003ca href=\"https://github.com/rust-lang/rust/blob/master/compiler/rustc_codegen_gcc/src/asm.rs\" rel=\"nofollow\" target=\"_blank\"\u003erustc_codegen_gcc/asm.rs\u003c/a\u003e to see how the project translates rust inline assembly to gcc inline assembly IR (IR here represents the result after the parser has finished parsing it and the semantics have been transformed (per the \u003ca href=\"https://github.com/rust-lang/rust/blob/master/compiler/rustc_codegen_gcc/src/asm.rs\" rel=\"nofollow\" target=\"_blank\"\u003easm.rs\u003c/a\u003e file's comment) and later can be used solely to generate code).\u003c/p\u003e\n\u003cp\u003eAnother one is since rust asm uses formatting with arg, it will be helpful to consider  \u003ca href=\"https://github.com/rust-lang/rust/blob/master/compiler/rustc_parse_format/src/lib.rs\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/rust-lang/rust/blob/master/compiler/rustc_parse_format/src/lib.rs\u003c/a\u003e and see how they work with the formatting logic.\u003c/p\u003e\n\u003ch3 id=\"week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-4-june-17---june-24-improve-if-possible-asm-ast-in-rust-macro-builtins-implement-asm-hir-and-visitor\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 4 (June 17 - June 24): Improve (if possible) asm-AST in rust-macro-builtins, implement asm-HIR and visitor\u003c/h3\u003e\n\u003cp\u003eFrom \u003ca href=\"https://github.com/Rust-GCC/gccrs/issues/1566\" rel=\"nofollow\" target=\"_blank\"\u003eRust-GCC/gccrs#1566\u003c/a\u003e, asm-AST has already been implemented, I am to implement asm-HIR and its visitor instead.\u003c/p\u003e\n\u003cp\u003eThe AST (Abstract syntax tree) is the result of the Rust Inline Assembly Parser. This AST will be transformed to a HIR (High Level Intermediate Representation) through a process called \u003ccode\u003eLowering.\u003c/code\u003e This IR helps us perform multiple syntax desugaring, as well as type-checking or borrow checking through the uses of its visitors.\u003c/p\u003e\n\u003cp\u003eThis subpart is done after parsing so that we know what our asm-HIR needs from the parser.\u003c/p\u003e\n\u003cp\u003eTesting-wise, I’m not sure there is any testing to be done for this part.\u003c/p\u003e\n\u003ch3 id=\"week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-5-june-24---july-1-implement-handlers-for-asm-creating-ast-asm-from-a-stream-of-tokens\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 5 (June 24 - July 1): Implement handlers for asm, creating AST asm from a stream of tokens.\u003c/h3\u003e\n\u003cp\u003eFrom the available parser, I can use it in conjunction with asm-nodes and asm-AST in rust-macro-builtsin, outputing the asm-AST that I have declared and defined.\u003c/p\u003e\n\u003cp\u003eNo testing on this part.\u003c/p\u003e\n\u003ch3 id=\"week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-6-7-july-1---july-15-work-with-astlowering-lowering-the-asm-ast-to-hir-high-level-ir\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 6-7 (July 1 - July 15): Work with ASTLowering, lowering the asm-AST to HIR (high level IR).\u003c/h3\u003e\n\u003cp\u003eThe main classes to deal with are ASTLowering* in the gcc/rust/hir folder. I would create a new class inheriting from ASTLoweringBase and a constructor from asm-AST to deal with lowering the asm-AST.\u003c/p\u003e\n\u003ch3 id=\"week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-7-8-july-15---july-29-work-with-generic-il-in-compile-converting-hir-to-generic-intermediate-language\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 7-8 (July 15 - July 29): Work with GENERIC IL in Compile*, converting HIR to GENERIC intermediate language.\u003c/h3\u003e\n\u003cp\u003eThe calls to express and create GENERIC tree will be provided via gcc/tree.def. For this part, some helpful definitions are present in gcc/c/c-typeck.cc\u003c/p\u003e\n\u003ch3 id=\"week-9-july-29---aug-5-end-to-end-testing\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-9-july-29---aug-5-end-to-end-testing\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 9 (July 29 - Aug 5): End-to-end testing.\u003c/h3\u003e\n\u003cp\u003eIntroduce end-to-end testing and fix all relevant bugs.\u003c/p\u003e\n\u003cp\u003eThe required testing involves testing existing inline assembly invocations taken directly from the Rust standard library, as well as testcases from rustc.\u003c/p\u003e\n\u003ch3 id=\"week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-11-12-aug-5---19-spare-time-allocation-for-different-parts-of-projects\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 11-12 (Aug 5 - 19): Spare time allocation for different parts of projects.\u003c/h3\u003e\n\u003cp\u003e2 week of free time will be allocated to different aspect of the project.\u003c/p\u003e\n\u003ch3 id=\"week-10-aug-19---aug-26-report-and-documentation\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#week-10-aug-19---aug-26-report-and-documentation\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eWEEK 10 (Aug 19 - Aug 26): Report and Documentation\u003c/h3\u003e\n\u003cp\u003eI will finish up my report and documentation before submission of my project.\u003c/p\u003e\n\u003ch2 id=\"responsibitiles-and-my-schedule\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#responsibitiles-and-my-schedule\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eResponsibitiles and my schedule.\u003c/h2\u003e\n\u003ch3 id=\"university\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#university\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eUniversity\u003c/h3\u003e\n\u003cp\u003eMy university spring semester ends on Friday, May 10, 2024 with my final exam on May 9.\u003c/p\u003e\n\u003cp\u003eMy university fall semester usually begins on August 23.\u003c/p\u003e\n\u003cp\u003eMy fall semester coursework will (likely) be:\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCS 265. Compiler Optimization and Code Generation (3 Units) (Grad)\u003c/li\u003e\n\u003cli\u003eCS 189: Introduction to Machine Learning (4 Units) (Ugrad)\u003c/li\u003e\n\u003cli\u003eCS 170: Efficient Algorithms and Intractable Problems (4 Units) (Ugrad)\u003c/li\u003e\n\u003c/ul\u003e\n\u003ch3 id=\"internship\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#internship\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eInternship\u003c/h3\u003e\n\u003cp\u003eI have an offer where the starting date will be end of May - early June and the ending date will be on the second week of August.\u003c/p\u003e\n\u003cp\u003eI will be working on the project over the course of May to August 26.\u003c/p\u003e\n\u003cp\u003eIf I am unable to complete the project's goals, I will make sure to discuss an extension with my mentors at the earliest possible.\u003c/p\u003e\n\u003cp\u003eSuch detailed timeline coupled with comprehensive design document is to ensure my progress is consistent throughout.\u003c/p\u003e\n\u003ch1 id=\"design-doc\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#design-doc\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eDesign doc\u003c/h1\u003e\n\u003cp\u003eThe design doc is to help me plan out ahead my implementation and discuss them with my mentor.\u003c/p\u003e\n\u003ch2 id=\"lexer--parser-implementation\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#lexer--parser-implementation\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eLexer \u0026#x26; Parser implementation\u003c/h2\u003e\n\u003ch3 id=\"grammar\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#grammar\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eGrammar\u003c/h3\u003e\n\u003cp\u003eThe BNF grammar for the inline assembly is\u003c/p\u003e\n\u003cpre\u003e\u003ccode\u003eformat_string := STRING_LITERAL / RAW_STRING_LITERAL\ndir_spec := \"in\" / \"out\" / \"lateout\" / \"inout\" / \"inlateout\"\nreg_spec := \u0026#x3C;register class\u003e / \"\\\"\" \u0026#x3C;explicit register\u003e \"\\\"\"\noperand_expr := expr / \"_\" / expr \"=\u003e\" expr / expr \"=\u003e\" \"_\"\nreg_operand := [ident \"=\"] dir_spec \"(\" reg_spec \")\" operand_expr\nclobber_abi := \"clobber_abi(\" \u0026#x3C;abi\u003e *(\",\" \u0026#x3C;abi\u003e) [\",\"] \")\"\noption := \"pure\" / \"nomem\" / \"readonly\" / \"preserves_flags\" /\n        \"noreturn\" / \"nostack\" / \"att_syntax\" / \"raw\"\noptions := \"options(\" option *(\",\" option) [\",\"] \")\"\noperand := reg_operand / clobber_abi / options\nasm := \"asm!(\" format_string *(\",\" format_string)\n    *(\",\" operand) [\",\"] \")\"\nglobal_asm := \"global_asm!(\" format_string\n    *(\",\" format_string) *(\",\" operand) [\",\"] \")\"\n\nend := asm | global_asm\n\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003ewhere the end result will be an \u003ccode\u003eend\u003c/code\u003e.\u003c/p\u003e\n\u003ch3 id=\"implementation\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#implementation\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eImplementation\u003c/h3\u003e\n\u003cp\u003eThe lexer I'll be using on this part will be the \u003ccode\u003eMacroInvocLexer\u003c/code\u003e via \u003ccode\u003eMacroInvocLexer lex (invoc.get_delim_tok_tree ().to_token_stream ());\u003c/code\u003e. It serves as a parameter for my parser like\n\u003ccode\u003eParser\u0026#x3C;MacroInvocLexer\u003e parser (lex);\u003c/code\u003e\u003c/p\u003e\n\u003cp\u003eWith the parser called \u003ccode\u003ep\u003c/code\u003e, I can call the methods in \u003ccode\u003egcc/rust/parse/rust-parse.h\u003c/code\u003e on the parser to perform some recursive descent logic.\u003c/p\u003e\n\u003ch2 id=\"rust-asm-ast-hir-and-visitor\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#rust-asm-ast-hir-and-visitor\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003erust asm-ast, HIR, and visitor\u003c/h2\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// Namespace HIR\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// In rust-hir-exp.h\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003eInlineAsm : ExprWithoutBlock \u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e{\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003e    ...\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e}\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e// in rust-hir.cc\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#CA9EE6\"\u003evoid\u003c/span\u003e\u003cspan style=\"color:#E5C890\"\u003e InlineAsm\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eaccept\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#E5C890;font-style:italic\"\u003eHIRExpressionVisitor\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e \u0026#x26;\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003evis\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e {\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003e    vis\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e.\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003evisit\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e*\u003c/span\u003e\u003cspan style=\"color:#E78284\"\u003ethis\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e);\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThe visitor for HIR::InlineAsm is HIRExpressionVisitor.\u003c/p\u003e\n\u003ch2 id=\"asm-handlers\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#asm-handlers\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003easm-handlers\u003c/h2\u003e\n\u003cp\u003eI need to add two entries which are the handler functions to the \u003ccode\u003egcc/rust/expand/rust-macro-builtins.cc\u003c/code\u003e's \u003ccode\u003eMacroBuiltin::builtin_transcribers\u003c/code\u003e and remove the \u003ccode\u003ellvm_asm\u003c/code\u003e key from the map.\u003c/p\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"asm\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#E5C890\"\u003e MacroBuiltin\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003easm_handler\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e},\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"llvm_asm\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#E5C890\"\u003e MacroBuiltin\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003esorry\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e},\u003c/span\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e // Remove this.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#949CBB\"\u003e{\u003c/span\u003e\u003cspan style=\"color:#A6D189\"\u003e\"global_asm\"\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#E5C890\"\u003e MacroBuiltin\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e::\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eglobal_asm_handler\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e},\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eI also need to define the two handlers in \u003ccode\u003egcc/rust/expand/rust-macro-builtins.h\u003c/code\u003e. They both will\u003c/p\u003e\n\u003cul\u003e\n\u003cli\u003eCall the parser I implement in the previous part, get the AST::asm from it.\u003c/li\u003e\n\u003cli\u003eTransform the \u003ccode\u003eAST::asm\u003c/code\u003e node to an \u003ccode\u003eAST::Fragment\u003c/code\u003e\u003c/li\u003e\n\u003cli\u003eReturn the \u003ccode\u003eAST::Fragment\u003c/code\u003e.\u003c/li\u003e\n\u003c/ul\u003e\n\u003cp\u003eAn \u003ccode\u003eAST::Fragment\u003c/code\u003e is an AST that can be incorporated back to the AST produced by the general parser. The main reasoning for not returning the \u003ccode\u003eAST::asm\u003c/code\u003e but instead opting for \u003ccode\u003eAST::Fragment\u003c/code\u003e is because of the process described by \u003ca href=\"https://github.com/rust-lang/rustc-dev-guide/blob/master/src/macro-expansion.md\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/rust-lang/rustc-dev-guide/blob/master/src/macro-expansion.md\u003c/a\u003e\u003c/p\u003e\n\u003ch2 id=\"astlowering\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#astlowering\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eASTLowering\u003c/h2\u003e\n\u003ch2 id=\"converting-hir-to-generic-intermediate-language\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#converting-hir-to-generic-intermediate-language\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eConverting HIR to GENERIC intermediate language\u003c/h2\u003e\n\u003cp\u003eDocument for GENERIC asm is at \u003ca href=\"https://gcc.gnu.org/onlinedocs/gccint/Basic-Statements.html\" rel=\"nofollow\" target=\"_blank\"\u003eGENERIC\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eIn gcc/c/c-typeck.cc, there is the provided build_asm_expr which I can use to generate GENERIC\u003c/p\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003etree\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003ebuild_asm_expr\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#E5C890;font-style:italic\"\u003elocation_t\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003e loc\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e tree \u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003estring\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e tree \u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eoutputs\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e tree \u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003einputs\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003e\t\ttree \u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eclobbers\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e tree \u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003elabels\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e bool\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003e simple\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e bool\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003e is_inline\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e);\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eThere are also some macro definitions in \u003ccode\u003egcc/tree.h\u003c/code\u003e that are helpful in manipulating tree expr.\u003c/p\u003e\n\u003cp\u003eFor example, from line 1381 to 1385\u003c/p\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e/* ASM_EXPR accessors. ASM_STRING returns a STRING_CST for the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   instruction (e.g., \"mov x, y\"). ASM_OUTPUTS, ASM_INPUTS, and\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   ASM_CLOBBERS represent the outputs, inputs, and clobbers for the\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   statement.  */\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E5C890\"\u003e#define\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e ASM_STRING\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e        TREE_OPERAND\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eASM_EXPR_CHECK\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 0\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E5C890\"\u003e#define\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e ASM_OUTPUTS\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e       TREE_OPERAND\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eASM_EXPR_CHECK\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 1\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E5C890\"\u003e#define\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e ASM_INPUTS\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e        TREE_OPERAND\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eASM_EXPR_CHECK\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 2\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E5C890\"\u003e#define\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e ASM_CLOBBERS\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e      TREE_OPERAND\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eASM_EXPR_CHECK\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 3\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#E5C890\"\u003e#define\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e ASM_LABELS\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e(\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003e\t    TREE_OPERAND\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003eASM_EXPR_CHECK\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003eNODE\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e),\u003c/span\u003e\u003cspan style=\"color:#EF9F76\"\u003e 4\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003cp\u003eAnother point worth mentioning that since these ASM accessors are nothing but STRING_CST, it would be helpful to be able to determine how to build a STRING_CST. The detailed documentation in \u003ccode\u003egcc/tree.cc\u003c/code\u003e is:\u003c/p\u003e\n\u003cpre class=\"shiki catppuccin-frappe\" style=\"background-color:#303446;color:#c6d0f5\" tabindex=\"0\"\u003e\u003ccode\u003e\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e/* Return a newly constructed STRING_CST node whose value is the LEN\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   characters at STR when STR is nonnull, or all zeros otherwise.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   Note that for a C string literal, LEN should include the trailing NUL.\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e   The TREE_TYPE is not initialized.  */\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#C6D0F5\"\u003etree\u003c/span\u003e\u003c/span\u003e\n\u003cspan class=\"line\"\u003e\u003cspan style=\"color:#8CAAEE;font-style:italic\"\u003ebuild_string\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e (\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003eunsigned\u003c/span\u003e\u003cspan style=\"color:#EA999C;font-style:italic\"\u003e len\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e,\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e const\u003c/span\u003e\u003cspan style=\"color:#CA9EE6\"\u003e char\u003c/span\u003e\u003cspan style=\"color:#81C8BE\"\u003e *\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003estr\u003c/span\u003e\u003cspan style=\"color:#737994;font-style:italic\"\u003e /*= NULL */\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e)\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e {\u003c/span\u003e\u003cspan style=\"color:#C6D0F5\"\u003e...\u003c/span\u003e\u003cspan style=\"color:#949CBB\"\u003e}\u003c/span\u003e\u003c/span\u003e\u003c/code\u003e\u003c/pre\u003e\n\u003ch1 id=\"introduce-myself-my-skills-and-accomplishments\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#introduce-myself-my-skills-and-accomplishments\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eIntroduce myself, my skills and accomplishments\u003c/h1\u003e\n\u003ch2 id=\"information\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#information\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eInformation\u003c/h2\u003e\n\u003cp\u003eName: Jasmine Tang\u003c/p\u003e\n\u003cp\u003eEmail (personal): \u003ca href=\"mailto:tanghocle456@gmail.com\"\u003etanghocle456@gmail.com\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eEmail (personal): \u003ca href=\"mailto:thisisjjasmine@gmail.com\"\u003ethisisjjasmine@gmail.com\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eEmail (University): \u003ca href=\"mailto:jjasmine@berkeley.edu\"\u003ejjasmine@berkeley.edu\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eGitHub: \u003ca href=\"https://github.com/badumbatish\" rel=\"nofollow\" target=\"_blank\"\u003ebadumbatish\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eResume (continually updated): \u003ca href=\"https://www.overleaf.com/read/bzvddqdhfdqp#fb6509\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://www.overleaf.com/read/bzvddqdhfdqp#fb6509\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eUniversity: University of California Berkeley\u003c/p\u003e\n\u003ch2 id=\"about-myself\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#about-myself\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eAbout myself\u003c/h2\u003e\n\u003cp\u003eHi everyone, I’m Jasmine. I’m currently a junior undergraduate at UC Berkeley majoring in EECS. This semester, I am taking an undergraduate compiler and will be taking a grad class about code optimization this upcoming Fall.\u003c/p\u003e\n\u003cp\u003eI’ve been programming in C, C++, Python, Java, Rust, mainly C/C++ and have done projects in relation to C++ and compilers\u003c/p\u003e\n\u003cp\u003eRegarding compilers,  one of my projects include building a Scheme (Lisp dialect) Interpreter with recursive descent parsing in Python. As a semester-long class project, I am also building a ChocoPy compiler (a statically-typed subset of Python) with Java’s lexer and Java’s LALR(1) parser generator, writing passes for semantic checking and type-checking, as well as generating RISC-V assembly code. I just recently finished the LLVM’s Kaleidoscope tutorial and am trying to refactor the LLVM-based compiler as my own hobby project; currently I have gotten lexing and parsing refactored.\u003c/p\u003e\n\u003cp\u003eI’ve also done a number of projects related to C/C++. Some includes reimplementing std::vector with the standard allocator. As another semester-long class project, I’m working on PintOS, an educational operating system, adding support for syscalls, multiprocessing and multithreading and file systems.\u003c/p\u003e\n\u003ch2 id=\"my-contribution-to-gccrs\"\u003e\u003ca aria-hidden=\"true\" tabindex=\"-1\" href=\"#my-contribution-to-gccrs\"\u003e\u003cspan class=\"icon icon-link\"\u003e\u003c/span\u003e\u003c/a\u003eMy contribution to gccrs\u003c/h2\u003e\n\u003cp\u003eI want to preface this by saying all of this contribution would not be possible if not for my potential mentor Arthur.\u003c/p\u003e\n\u003cp\u003eI joined gccrs' Zulip channel in late febuary / early March and since have put in some pull requests for the repository as well as contributed an ARM-based Ubuntu Docker image tailored to development of gccrs with persistent storage settings and different hotswappable versions of the image via docker compose at \u003ca href=\"https://github.com/badumbatish/gccrs-workspace\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/badumbatish/gccrs-workspace\u003c/a\u003e.\u003c/p\u003e\n\u003cp\u003eMy first contribution was adding tl::optional typing to MacroBuiltin map, a data structure I need to familiar with for this project.\u003c/p\u003e\n\u003cp\u003eThe second contribution was to refactor all macro handlers into different themes to ease navigation and development.\u003c/p\u003e\n\u003cp\u003eFor the third and fourth one, I fixed a error emitting bug when late-resolving an id expression and fixed visibility storage from parsing ExternalTypeItem until HIR construction.\u003c/p\u003e\n\u003cp\u003ePlease feel free to see a list of my pull requests to gccrs at \u003ca href=\"https://github.com/Rust-GCC/gccrs/pulls?q=is%3Apr+author%3Abadumbatish+\" rel=\"nofollow\" target=\"_blank\"\u003ehttps://github.com/Rust-GCC/gccrs/pulls?q=is%3Apr+author%3Abadumbatish+\u003c/a\u003e\u003c/p\u003e\n\u003cp\u003eor by putting \u003ccode\u003eis:pr author:badumbatish\u003c/code\u003e in the pull request search bar.\u003c/p\u003e\n\u003cp\u003eor by selecting \u003ccode\u003ebadumbatish\u003c/code\u003e as author in mobile.\u003c/p\u003e"])</script><script>self.__next_f.push([1,"6:[\"$\",\"div\",null,{\"className\":\"py-12 flex flex-col items-center  justify-items-start mx-auto \",\"children\":[[\"$\",\"$L2\",null,{\"href\":\"/blog\",\"className\":\"flex justify-center text-4xl\",\"children\":[\"$\",\"h2\",null,{\"children\":\"My blog\"}]}],[\"$\",\"article\",null,{\"className\":\"p-8 prose pt-0.5 max-w-none w-full lg:w-1/2 md:w-4/6 sm:w-5/6 prose-sky mx-auto\",\"children\":[[\"$\",\"div\",null,{\"className\":\"flex justify-center text-2xl font-bold \",\"children\":[\"$\",\"h2\",null,{\"children\":\"jjasmine’s Gsoc GCCRS proposal\"}]}],[\"$\",\"div\",null,{\"className\":\"flex justify-start text-xl font-bold underline\",\"children\":[\"$\",\"h4\",null,{\"children\":\"2024-05-04\"}]}],[\"$\",\"div\",null,{\"className\":\"flex font-bold\",\"children\":\"Edit:\"}],\"My resume is \",[\"$\",\"a\",null,{\"href\":\"https://badumbatish.github.io/about_me/Jasmine_Resume_Badumbatish.pdf\",\"children\":\"here\"}],\". If you know of a compiler related job posting, please feel free to contact me or refer me at either \",[\"$\",\"a\",null,{\"href\":\"tanghocle456@gmail.com\",\"children\":\"tanghocle456@gmail.com\"}],\" or \",[\"$\",\"a\",null,{\"href\":\"jjasmine@berkeley.edu\",\"children\":\"jjasmine@berkeley.edu\"}],\".\",[\"$\",\"hr\",null,{}],[\"$\",\"div\",null,{\"dangerouslySetInnerHTML\":{\"__html\":\"$e\"}}]]}]]}]\na:[[\"$\",\"meta\",\"0\",{\"charSet\":\"utf-8\"}],[\"$\",\"title\",\"1\",{\"children\":\"jjasmine’s Gsoc GCCRS proposal\"}],[\"$\",\"meta\",\"2\",{\"name\":\"description\",\"content\":\"Built with NextJS, TailwindCSS, and a tonnn of loveee :)\"}],[\"$\",\"link\",\"3\",{\"rel\":\"icon\",\"href\":\"/_next/static/media/pfp5.0daa0f7d.jpeg\"}]]\n8:null\n"])</script></body></html>